# /Users/user/Desktop/Core Guild Project/projects/colabs/eng-teams/core/personal-website/prototype/.github/workflows/release.yml
# Purpose: Manually create a new versioned Git tag and GitHub Release.
name: 📦 Manual Release

on:
  workflow_dispatch:
    inputs:
      version:
        description: 'Release version (e.g., v1.2.3)'
        required: true

jobs:
  create-release:
    name: 📦 Create Release
    runs-on: ubuntu-latest
    permissions:
      contents: write # Required to create tags and releases
    steps:
      - name:  checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0 # Required to get all tags

      - name: 🛡️ Check if release already exists
        id: check_release
        run: |
          if gh release view ${{ github.event.inputs.version }} > /dev/null 2>&1; then
            echo "::error::Release ${{ github.event.inputs.version }} already exists."
            exit 1
          else
            echo "Release ${{ github.event.inputs.version }} does not exist. Proceeding."
          fi
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: 📝 Generate Changelog (Placeholder)
        id: changelog
        run: |
          # For a production-grade setup, use a tool like 'git-cliff' to auto-generate this.
          echo "Automated release for version ${{ github.event.inputs.version }}." > changelog.md

      - name: 🚀 Create GitHub Release and Tag
        run: |
          gh release create ${{ github.event.inputs.version }} \
            --title "Release ${{ github.event.inputs.version }}" \
            --notes-file changelog.md
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }} 